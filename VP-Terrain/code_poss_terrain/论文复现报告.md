# TerraFusion 论文复现实验报告

## 一、实验概述

本报告展示了 TerraFusion 论文的复现实验结果，在 VP-Terrain 数据集的 **Dark（暗光）测试条件**下，对比了 100% 标注数据和 5% 标注数据两种设置下的模型性能，并与论文原始结果进行对比分析。

---

## 二、实验设置

| 配置项 | 设置值 |
|--------|--------|
| 数据集 | VP-Terrain (Dark 测试集) |
| 测试样本数 | 4,274 |
| 类别数 | 7 (asphalt, grass, concrete, brick, flagstone, plastic, sand) |
| 标注比例 | 100% / 5% |
| 温度参数 T | 0.3 |

---

## 三、整体准确率对比


| 模型 | 论文 (5%) | 复现 (5%) | 复现 (100%) | 
|------|-----------|-----------|-------------|
| **ProNet (机体网络)** | 85.33% | **83.15%** | 81.61% | 
| **TerraFusion (融合)** | 85.35% | **83.22%** | 81.66% |


---

## 四、各类别准确率详细对比

### 4.1 复现结果：5% vs 100% 标注数据

| 类别 | 样本数 | ProNet (100%) | ProNet (5%) | VisionNet (100%) | VisionNet (5%) | Fusion (100%) | Fusion (5%) |
|------|--------|---------------|-------------|------------------|----------------|---------------|-------------|
| 类别 0 | 1,131 | 74.45% | **75.86%** | **93.72%** | 78.07% | 74.54% | **76.04%** |
| 类别 1 | 433 | 97.92% | **98.38%** | 0.00% | 0.00% | 97.92% | **98.38%** |
| 类别 2 | 536 | 84.14% | **86.57%** | 0.00% | **34.33%** | 84.14% | **86.57%** |
| 类别 3 | 523 | **99.24%** | 99.04% | 0.00% | 0.00% | **99.24%** | 99.04% |
| 类别 4 | 411 | 81.02% | **82.48%** | 0.00% | 0.00% | 81.02% | **82.48%** |
| 类别 5 | 892 | 79.04% | **82.40%** | 8.97% | **52.69%** | 79.15% | **82.51%** |
| 类别 6 | 348 | 61.49% | 61.49% | 0.00% | 0.00% | 61.49% | 61.49% |
| **平均** | **4,274** | **81.61%** | **83.15%** | **26.67%** | **35.96%** | **81.66%** | **83.22%** |

### 4.2 发现

#### 5% 标注数据优于 100%

| 对比项 | 100% 标注 | 5% 标注 | 差异 |
|--------|-----------|---------|------|
| ProNet | 81.61% | **83.15%** | +1.54% |
| VisionNet | 26.67% | **35.96%** | +9.29% |
| Fusion | 81.66% | **83.22%** | +1.56% |

**原因分析**：
- **半监督学习可以减少对标注数据的依赖**
- 使用全部标注数据可能导致**过拟合**
- 5% 的标注数据配合自监督预训练能够学到更泛化的特征


## 附录：复现输出文件

### 文件目录结构

```
SSL_pos/
├── mobilenet_0.05/                    # 5% 标注数据训练结果
│   ├── new_lab.txt                    # KMeans 生成的伪标签
│   ├── only_pro.pth                   # 机体网络模型权重
│   ├── only_vision.pth                # 视觉网络模型权重
│   ├── pro_dark_conf                  # 机体网络置信度矩阵 (N×7)
│   ├── pro_dark_conf_max              # 机体网络最大置信度
│   ├── pro_dark_prediction            # 机体网络预测结果
│   ├── vision_dark_conf               # 视觉网络置信度矩阵 (N×7)
│   ├── vision_dark_conf_max           # 视觉网络最大置信度
│   └── vision_dark_prediction         # 视觉网络预测结果
│
└── mobilenet_1/                       # 100% 标注数据训练结果
    ├── new_lab.txt                    # KMeans 生成的伪标签
    ├── only_pro.pth                   # 机体网络模型权重
    ├── only_vision.pth                # 视觉网络模型权重
    ├── pro_dark_conf                  # 机体网络置信度矩阵 (N×7)
    ├── pro_dark_conf_max              # 机体网络最大置信度
    ├── pro_dark_prediction            # 机体网络预测结果
    ├── vision_dark_conf               # 视觉网络置信度矩阵 (N×7)
    ├── vision_dark_conf_max           # 视觉网络最大置信度
    └── vision_dark_prediction         # 视觉网络预测结果
```
### 使用方法


| 步骤 | 操作 | 说明 |
|------|------|------|
| 1 | 设置 `Config.py` 中 `alpha = 1.0` | 100% 标注数据 |
| 2 | 运行 `test_cluster_prediction.py` | 生成机体网络预测结果 |
| 3 | 运行 `test_only_vision.py` | 生成视觉网络预测结果 + 融合 |
| 4 | 运行 `judge_1.py` | 输出 100% 标注数据的评估结果 |
| 5 | 设置 `Config.py` 中 `alpha = 0.05` | 5% 标注数据 |
| 6 | 运行 `test_cluster_prediction.py` | 生成机体网络预测结果 |
| 7 | 运行 `test_only_vision.py` | 生成视觉网络预测结果 + 融合 |
| 8 | 运行 `judge_0.05.py` | 输出 5% 标注数据的评估结果 |

---

